services:
  # Main Web Service
  - type: web
    name: ai-agentic-honeypot-system
    runtime: python
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: PYTHON_VERSION
        value: 3.13.1
      - key: API_KEY
        sync: false  # Set this in Render Dashboard as secret
      - key: ANTHROPIC_API_KEY
        sync: false  # Set this in Render Dashboard as secret
      - key: LLM_PROVIDER
        value: anthropic
      - key: ANTHROPIC_MODEL
        value: claude-haiku-4.5-20250110
      - key: LLM_MAX_TOKENS_DETECTION
        value: 500
      - key: LLM_MAX_TOKENS_RESPONSE
        value: 300
      - key: GEMINI_MODEL
        value: models/gemini-2.5-flash
      - key: CACHE_MAX_SIZE
        value: 500
      - key: LLM_REQUEST_TIMEOUT
        value: 5
      - key: SESSION_TIMEOUT_MINUTES
        value: 30
      - key: MAX_MESSAGES_PER_SESSION
        value: 50
      - key: SCAM_SCORE_THRESHOLD
        value: 2

  # Cron Job - Keep Alive (prevents cold starts)
  - type: cron
    name: honeypot-keep-alive
    runtime: python
    schedule: "*/10 * * * *"  # Every 10 minutes
    buildCommand: pip install requests
    startCommand: python scripts/keep_alive.py
